markdown
# Strawberry SQLAlchemy Mapper

[![PyPI Version][pypi-badge]][pypi-url]  
![python][python-badge]  
[![Downloads][downloads-badge]][pypi-url]  
[![Test Coverage][coverage-badge]][coverage-url]  
[![CI/CD Status][ci-badge]][ci-url]  
[![Discord][discord-badge]][discord-url]

The simplest way to implement autogenerated Strawberry types for columns and relationships in SQLAlchemy models.

## Getting Started

### Installation
```bash
pip install strawberry-sqlalchemy-mapper
```

### Basic Usage
```python
# models.py
from sqlalchemy import Column, String, UUID, ForeignKey
from sqlalchemy.orm import relationship
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class Department(Base):
    __tablename__ = "department"
    id = Column(UUID, primary_key=True)
    name = Column(String, nullable=False)

class Employee(Base):
    __tablename__ = "employee"
    id = Column(UUID, primary_key=True)
    name = Column(String, nullable=False)
    department_id = Column(UUID, ForeignKey("department.id"))
    department = relationship("Department", back_populates="employees")

Department.employees = relationship("Employee", back_populates="department")
```

```python
# schema.py
from strawberry_sqlalchemy_mapper import StrawberrySQLAlchemyMapper

mapper = StrawberrySQLAlchemyMapper()

@mapper.type(Employee)
class EmployeeType:
    __exclude__ = ["password_hash"]  # Exclude sensitive fields

@mapper.type(Department)
class DepartmentType:
    pass

@strawberry.type
class Query:
    @strawberry.field
    def departments(self) -> List[DepartmentType]:
        return session.scalars(select(Department)).all()

schema = strawberry.Schema(query=Query)
mapper.finalize()  # Finalize all mapped types
```

## Feature Status

### Core Functionality
- [x] Auto-mapping for columns/relationships
- [x] Automatic N+1 query prevention
- [x] SQLAlchemy 1.4 & 2.0 support
- [x] Type customization via `__exclude__` and `__rename__`

### Performance
- [x] <1ms overhead per type generation
- [x] Caching for generated types
- [ ] Lazy type initialization (in progress)

### Integrations
- [x] GraphiQL Debug Toolbar
- [x] Strawberry Federation support
- [ ] Apollo Tracing (planned)

## Complete Reference

### Type Support
| SQLAlchemy Type       | Strawberry Equivalent      | Notes                  |
|-----------------------|---------------------------|------------------------|
| `Integer`             | `int`                     | Full support           |
| `String`              | `str`                     |                        |
| `DateTime`            | `datetime.datetime`       |                        |
| `JSON`                | `strawberry.scalars.JSON` | Requires manual setup  |
| `ARRAY[T]`            | `List[T]`                 | PostgreSQL only        |

### Limitations
- Composite primary keys require manual configuration
- Polymorphic hierarchies need interface registration
- TypeDecorator types need custom resolvers
- Dynamic relationship loaders not supported

## Contributing

We welcome contributions! Please follow these steps:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/your-feature`)
3. Commit your changes (`git commit -m 'Add some feature'`)
4. Push to the branch (`git push origin feature/your-feature`)
5. Open a Pull Request

### Development Setup
```bash
git clone https://github.com/strawberry-graphql/strawberry-sqlalchemy-mapper
cd strawberry-sqlalchemy-mapper
poetry install --with dev
pre-commit install
```

## Resources
- [Full Documentation][docs-url]
- [Report an Issue][issues-url]
- [Join Our Discord][discord-url]

<!-- Badge Links -->
[pypi-badge]: https://img.shields.io/pypi/v/strawberry-sqlalchemy-mapper?color=blue
[pypi-url]: https://pypi.org/project/strawberry-sqlalchemy-mapper/
[python-badge]: https://img.shields.io/pypi/pyversions/strawberry-sqlalchemy-mapper
[downloads-badge]: https://img.shields.io/pypi/dm/strawberry-sqlalchemy-mapper.svg?color=blue
[ci-badge]: https://img.shields.io/github/actions/workflow/status/strawberry-graphql/strawberry-sqlalchemy/test.yml?branch=main
[ci-url]: https://github.com/strawberry-graphql/strawberry-sqlalchemy/actions
[coverage-badge]: https://codecov.io/gh/strawberry-graphql/strawberry-sqlalchemy/branch/main/graph/badge.svg
[coverage-url]: https://codecov.io/gh/strawberry-graphql/strawberry-sqlalchemy
[issues-url]: https://github.com/strawberry-graphql/strawberry-sqlalchemy/issues
[discord-badge]: https://img.shields.io/discord/689806334417829898?color=7389D8&logo=discord
[discord-url]: https://strawberry.rocks/discord
[docs-url]: https://strawberry-graphql.github.io/strawberry-sqlalchemy-mapper
